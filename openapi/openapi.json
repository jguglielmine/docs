{"openapi":"3.1.0","info":{"title":"Qevlar Investigation Platform API","description":"This API analyzes observables and provides investigation capabilities.","version":"2.0.0"},"paths":{"/store-alert":{"post":{"tags":["Alert"],"summary":"Send an alert to Qevlar AI","description":"Sends an alert to Qevlar AI without triggering an investigation.","operationId":"store_alert_store_alert_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AlertSchema"}}},"required":true},"responses":{"200":{"description":"Alert successfully transferred.","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AlertResponseSchema"}}}},"401":{"description":"Missing, invalid or expired authentication token"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"HTTPBearer":[]}]}},"/v2/investigations/email":{"post":{"tags":["v2","investigation"],"summary":"New Investigation From Email","operationId":"new_investigation_from_email_v2_investigations_email_post","parameters":[{"name":"authorization","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Authorization"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/InvestigationEmailRequest"}}}},"responses":{"202":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/InvestigationSubmissionResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v2/investigations/eml":{"post":{"tags":["v2","investigation"],"summary":"Request Investigation From Eml","operationId":"request_investigation_from_eml_v2_investigations_eml_post","requestBody":{"content":{"multipart/form-data":{"schema":{"$ref":"#/components/schemas/Body_request_investigation_from_eml_v2_investigations_eml_post"}}},"required":true},"responses":{"202":{"description":"Investigation request accepted","content":{"application/json":{"schema":{"$ref":"#/components/schemas/InvestigationSubmissionResponse"}}}},"422":{"description":"Invalid investigation request format"},"401":{"description":"Missing, invalid or expired authentication token"}},"security":[{"HTTPBearer":[]}]}},"/v2/investigations/{alert_id}/result":{"get":{"tags":["v2","Investigation"],"summary":"Get investigation result","description":"Get an investigation's incident report. alert ID was in /investigation's POST response.","operationId":"get_investigation_result_v2_investigations__alert_id__result_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"alert_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Alert Id"}}],"responses":{"200":{"description":"Investigation result found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AlertDTO"}}}},"202":{"description":"Investigation is still in progress"},"401":{"description":"Missing, invalid or expired authentication token"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v2/investigations/{alert_id}/html":{"get":{"tags":["v2","Investigation"],"summary":"Get HTML investigation result","description":"Get an investigation's incident report in HTML format. Alert ID was in /investigation's POST response.","operationId":"get_investigation_result_html_v2_investigations__alert_id__html_get","security":[{"HTTPBearer":[]}],"parameters":[{"name":"alert_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Alert Id"}},{"name":"short","in":"query","required":false,"schema":{"type":"boolean","default":false,"title":"Short"}}],"responses":{"200":{"description":"HTML investigation result found","content":{"text/html":{"schema":{"type":"string"}}}},"202":{"description":"Investigation is still in progress"},"404":{"description":"Investigation not found"},"401":{"description":"Missing, invalid or expired authentication token"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/v2/investigations":{"post":{"tags":["v2","Investigation"],"summary":"Send alert for investigation by Qevlar AI.","description":"Request the investigation of an alert by identifying observables and assessing its overall risk.","operationId":"request_investigation_v2_investigations_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/InvestigationRequest"}}},"required":true},"responses":{"202":{"description":"Investigation request accepted","content":{"application/json":{"schema":{"$ref":"#/components/schemas/InvestigationSubmissionResponse"}}}},"422":{"description":"Invalid investigation request format"},"401":{"description":"Missing, invalid or expired authentication token"}},"security":[{"HTTPBearer":[]}]}},"/v2/investigations/{alert_id}/feedback":{"put":{"tags":["v2","Investigation"],"summary":"Review feedback.","description":"Send a feedback to a review.","operationId":"_put_investigation_feedback_v2_investigations__alert_id__feedback_put","security":[{"HTTPBearer":[]}],"parameters":[{"name":"alert_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Alert Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PostFeedbackRequest"}}}},"responses":{"200":{"description":"Feedback as been saved.","content":{"application/json":{"schema":{"anyOf":[{"$ref":"#/components/schemas/FeedbackDTO"},{"type":"null"}],"title":"Response  Put Investigation Feedback V2 Investigations  Alert Id  Feedback Put"}}}},"404":{"description":"Given alert id isn't associated with an investigation, or profile doesn't have access."},"401":{"description":"Missing, invalid or expired authentication token"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}}},"components":{"schemas":{"ActionType":{"type":"string","enum":["Checked reputation using CTI","Analyzed endpoint data","Browsed logs in internal sources","Investigated anomalies and security events","Browsed email logs","Browsed file logs","Browsed previous alerts logs","Browsed process logs","Browsed proxy logs","Examined for security threats","Analyzed events"],"title":"ActionType"},"AlertDTO":{"properties":{"id":{"type":"string","format":"uuid","title":"Id"},"profile_id":{"type":"string","format":"uuid","title":"Profile Id"},"external_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"External Id"},"metadata":{"anyOf":[{"$ref":"#/components/schemas/ClientInvestigateMetadata"},{"type":"null"}]},"title":{"type":"string","title":"Title"},"index":{"type":"integer","title":"Index"},"received_at":{"type":"string","format":"date-time","title":"Received At"},"description":{"type":"string","title":"Description"},"type":{"type":"string","title":"Type"},"insight_tags":{"items":{"$ref":"#/components/schemas/InsightTag"},"type":"array","title":"Insight Tags"},"investigation":{"$ref":"#/components/schemas/InvestigationDTO"}},"type":"object","required":["id","profile_id","external_id","metadata","title","index","received_at","description","type","insight_tags","investigation"],"title":"AlertDTO"},"AlertResponseSchema":{"properties":{"request_id":{"type":"string","format":"uuid","title":"Request Id","description":"A unique identifier for the alert which you can share with Qevlar AI support."}},"type":"object","required":["request_id"],"title":"AlertResponseSchema"},"AlertSchema":{"properties":{"alert_json":{"type":"object","title":"Alert","description":"The alert to be sent to Qevlar AI."}},"type":"object","required":["alert_json"],"title":"AlertSchema"},"AlertType":{"type":"string","enum":["Almond","CortexN","CortexXDR","Email","Sentinel","Unknown","EDElevatorIpConnections","GuardDuty","LetsDefend","Sekoia","Splunk"],"title":"AlertType"},"Body_request_investigation_from_eml_v2_investigations_eml_post":{"properties":{"file":{"type":"string","format":"binary","title":"File"},"from_email":{"type":"string","title":"From Email"}},"type":"object","required":["file","from_email"],"title":"Body_request_investigation_from_eml_v2_investigations_eml_post"},"Classification":{"type":"string","enum":["Malicious","Safe","Suspicious"],"title":"Classification"},"ClientInvestigateMetadata":{"properties":{"items":{"items":{"$ref":"#/components/schemas/ClientInvestigateMetadataItem"},"type":"array","title":"Items"}},"type":"object","required":["items"],"title":"ClientInvestigateMetadata"},"ClientInvestigateMetadataItem":{"properties":{"type":{"$ref":"#/components/schemas/ClientInvestigateMetadataType"},"name":{"type":"string","title":"Name"},"value":{"type":"string","title":"Value"}},"type":"object","required":["type","name","value"],"title":"ClientInvestigateMetadataItem"},"ClientInvestigateMetadataType":{"type":"string","enum":["STRING","URL","PRIVATE"],"title":"ClientInvestigateMetadataType"},"CountryTag":{"properties":{"label":{"type":"string","title":"Label"},"scope":{"type":"string","const":"COUNTRY","title":"Scope","default":"COUNTRY"},"scanner_type":{"anyOf":[{"$ref":"#/components/schemas/ScannerType"},{"type":"null"}]}},"type":"object","required":["label"],"title":"CountryTag"},"DefaultTag":{"properties":{"label":{"type":"string","title":"Label"},"scope":{"type":"string","const":"DEFAULT","title":"Scope","default":"DEFAULT"},"scanner_type":{"anyOf":[{"$ref":"#/components/schemas/ScannerType"},{"type":"null"}]}},"type":"object","required":["label"],"title":"DefaultTag"},"FeedbackDTO":{"properties":{"outcome":{"$ref":"#/components/schemas/InvestigationOutcome"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"},"created_by":{"anyOf":[{"$ref":"#/components/schemas/UserDTO"},{"$ref":"#/components/schemas/ProfileDTO"}],"title":"Created By"},"created_at":{"type":"string","format":"date-time","title":"Created At"}},"type":"object","required":["outcome","description","created_by","created_at"],"title":"FeedbackDTO"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"InsightTag":{"properties":{"label":{"type":"string","title":"Label"},"scope":{"$ref":"#/components/schemas/TagScope"},"scanner_type":{"anyOf":[{"$ref":"#/components/schemas/ScannerType"},{"type":"null"}]},"description":{"type":"string","title":"Description"}},"type":"object","required":["label","scope","description"],"title":"InsightTag"},"InvestigationDTO":{"properties":{"started_at":{"type":"string","format":"date-time","title":"Started At"},"ended_at":{"type":"string","format":"date-time","title":"Ended At"},"observables":{"additionalProperties":{"$ref":"#/components/schemas/ObservableDTO"},"propertyNames":{"format":"uuid"},"type":"object","title":"Observables"},"report":{"$ref":"#/components/schemas/ReportDTO"}},"type":"object","required":["started_at","ended_at","observables","report"],"title":"InvestigationDTO"},"InvestigationEmailRequest":{"properties":{"from_email":{"type":"string","format":"email","title":"From Email"},"subject":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Subject","default":"Investigation by Qevlar AI"},"reply_to":{"anyOf":[{"type":"string","format":"email"},{"type":"null"}],"title":"Reply To"},"attachment_download_url":{"type":"string","minLength":1,"format":"uri","title":"Attachment Download Url"}},"type":"object","required":["from_email","attachment_download_url"],"title":"InvestigationEmailRequest"},"InvestigationOutcome":{"type":"string","enum":["INCONCLUSIVE","MALICIOUS","NOT_HARMFUL"],"title":"InvestigationOutcome"},"InvestigationRequest":{"properties":{"source_type":{"$ref":"#/components/schemas/AlertType"},"content":{"type":"object","title":"Content","description":"The alert content, to be investigated by Qevlar AI engine, should be provided as a JSON object literal.This data can either be in the form of a JSON object literal or a string that strictly follows the JSON specification."},"id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Id","description":"The unique identifier of the alert for display on the Qevlar AI platform. The ID must not exceed 200 characters in length."},"metadata":{"anyOf":[{"additionalProperties":{"type":"string"},"type":"object"},{"type":"null"}],"title":"Metadata","description":"Additional metadata for display on the Qevlar AI platform. This should be a dictionary with string or URL values, where each key is up to 40 characters long and each value is up to 500 characters long. You are responsible for ensuring that the URL is secure."}},"additionalProperties":false,"type":"object","required":["source_type","content"],"title":"InvestigationRequest"},"InvestigationSubmissionResponse":{"properties":{"alert_id":{"type":"string","format":"uuid","title":"Alert Id"},"status":{"$ref":"#/components/schemas/TaskStatus"}},"type":"object","required":["alert_id","status"],"title":"InvestigationSubmissionResponse"},"KeyFinding":{"properties":{"label":{"type":"string","title":"Label"},"value":{"type":"string","title":"Value"}},"type":"object","required":["label","value"],"title":"KeyFinding"},"ObservableDTO":{"properties":{"id":{"type":"string","format":"uuid","title":"Id"},"value":{"type":"string","title":"Value"},"type":{"$ref":"#/components/schemas/ObservableType"},"name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Name"},"metadata":{"anyOf":[{"type":"object"},{"type":"null"}],"title":"Metadata"},"tags":{"items":{"oneOf":[{"$ref":"#/components/schemas/DefaultTag"},{"$ref":"#/components/schemas/PredicateTag"},{"$ref":"#/components/schemas/CountryTag"}],"discriminator":{"propertyName":"scope","mapping":{"COUNTRY":"#/components/schemas/CountryTag","DEFAULT":"#/components/schemas/DefaultTag","PREDICATE":"#/components/schemas/PredicateTag"}}},"type":"array","title":"Tags","default":[]},"key_findings":{"items":{"$ref":"#/components/schemas/KeyFinding"},"type":"array","title":"Key Findings","default":[]},"extracted_from_alert":{"type":"boolean","title":"Extracted From Alert"},"discovered_in":{"items":{"$ref":"#/components/schemas/ScannerType"},"type":"array","title":"Discovered In","default":[]},"sources":{"items":{"$ref":"#/components/schemas/SourceUrl"},"type":"array","title":"Sources","default":[]}},"type":"object","required":["id","value","type","extracted_from_alert"],"title":"ObservableDTO"},"ObservableType":{"type":"string","enum":["Alert","Command line","Country","Domain","Email address","Email header","Email","File","Invalid","IP","Device","Process","URL","User"],"title":"ObservableType"},"PostFeedbackRequest":{"properties":{"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"},"outcome":{"$ref":"#/components/schemas/InvestigationOutcome"}},"type":"object","required":["description","outcome"],"title":"PostFeedbackRequest"},"PredicateTag":{"properties":{"label":{"type":"string","title":"Label"},"scope":{"type":"string","const":"PREDICATE","title":"Scope","default":"PREDICATE"},"scanner_type":{"anyOf":[{"$ref":"#/components/schemas/ScannerType"},{"type":"null"}]}},"type":"object","required":["label"],"title":"PredicateTag"},"ProfileDTO":{"properties":{"id":{"type":"string","format":"uuid","title":"Id"},"username":{"type":"string","title":"Username"}},"type":"object","required":["id","username"],"title":"ProfileDTO"},"ReportDTO":{"properties":{"id":{"type":"string","format":"uuid","title":"Id"},"outcome":{"$ref":"#/components/schemas/InvestigationOutcome"},"feedback":{"anyOf":[{"$ref":"#/components/schemas/FeedbackDTO"},{"type":"null"}]},"overview":{"items":{"additionalProperties":{"type":"string"},"type":"object"},"type":"array","title":"Overview"},"indicators":{"items":{"type":"string"},"type":"array","title":"Indicators"},"investigation_next_steps":{"items":{"type":"string"},"type":"array","title":"Investigation Next Steps"},"remediation_next_steps":{"items":{"type":"string"},"type":"array","title":"Remediation Next Steps"},"steps":{"items":{"$ref":"#/components/schemas/StepDTO"},"type":"array","title":"Steps"}},"type":"object","required":["id","outcome","feedback","overview","indicators","investigation_next_steps","remediation_next_steps","steps"],"title":"ReportDTO"},"ScannerError":{"properties":{"scanner_type":{"$ref":"#/components/schemas/ScannerType"}},"type":"object","required":["scanner_type"],"title":"ScannerError"},"ScannerErrorCode":{"type":"string","enum":["InvalidArgumentError","NoLogFoundError","NotFoundError","ObservableScanBlocked"],"title":"ScannerErrorCode"},"ScannerType":{"type":"string","enum":["AbuseIPDB","AlertEvidence","Anomalies","DeviceFileEvents","DeviceNetworkEvents","DeviceProcessEvents","EmailAttachmentInfo","EmailEvents","EmailUrlInfo","SecurityIncident","CommonSecurityLog","UrlClickEvents","UserRiskEvents","RegistryEvents","BigDataCloud","Cybereason AI Hunting","Cybereason Attack Tree","Cybereason Endpoint Protection","Cybereason Visual Search","IP Sub Type","Joe Sandbox","NOOP","Qevlar Eye","VirusTotal & UrlScan","UrlScan","VirusTotal","OPSWAT MetaDefender","SentinelOne File Events","SentinelOne Process Events","SentinelOne Behavior Events","SentinelOne Registry Events","xdr_data File Events","Zscaler","xdr_data Process Events","xdr_data Registry Events","xdr_data Related Alerts","xdr_data Network Events"],"title":"ScannerType"},"ScannerWarning":{"properties":{"scanner_type":{"$ref":"#/components/schemas/ScannerType"},"warning":{"$ref":"#/components/schemas/ScannerErrorCode"}},"type":"object","required":["scanner_type","warning"],"title":"ScannerWarning"},"SourceUrl":{"properties":{"scanner_type":{"$ref":"#/components/schemas/ScannerType"},"url":{"anyOf":[{"type":"string","minLength":1,"format":"uri"},{"type":"null"}],"title":"Url"}},"type":"object","required":["scanner_type","url"],"title":"SourceUrl"},"StepDTO":{"properties":{"id":{"type":"string","format":"uuid","title":"Id"},"type":{"$ref":"#/components/schemas/ActionType"},"title":{"type":"string","title":"Title"},"input_observable_id":{"type":"string","format":"uuid","title":"Input Observable Id"},"extracted_observable_ids":{"items":{"type":"string","format":"uuid"},"type":"array","title":"Extracted Observable Ids"},"classification":{"$ref":"#/components/schemas/Classification"},"insights":{"items":{"type":"string"},"type":"array","title":"Insights"},"errors":{"items":{"$ref":"#/components/schemas/ScannerError"},"type":"array","title":"Errors"},"warnings":{"items":{"$ref":"#/components/schemas/ScannerWarning"},"type":"array","title":"Warnings"},"started_at":{"type":"string","format":"date-time","title":"Started At"},"ended_at":{"type":"string","format":"date-time","title":"Ended At"},"sources":{"items":{"$ref":"#/components/schemas/SourceUrl"},"type":"array","title":"Sources"},"key_findings":{"items":{"$ref":"#/components/schemas/KeyFinding"},"type":"array","title":"Key Findings"}},"type":"object","required":["id","type","title","input_observable_id","extracted_observable_ids","classification","insights","errors","warnings","started_at","ended_at","sources","key_findings"],"title":"StepDTO"},"TagScope":{"type":"string","enum":["COUNTRY","DEFAULT","PREDICATE"],"title":"TagScope"},"TaskStatus":{"type":"string","enum":["Failure","In progress","Pending","Success"],"title":"TaskStatus"},"UserDTO":{"properties":{"id":{"type":"string","format":"uuid","title":"Id"},"username":{"type":"string","title":"Username"},"role":{"$ref":"#/components/schemas/UserRole"},"email":{"type":"string","title":"Email"}},"type":"object","required":["id","username","role","email"],"title":"UserDTO"},"UserRole":{"type":"string","enum":["ADMIN","ANALYST"],"title":"UserRole"},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"}},"securitySchemes":{"HTTPBearer":{"type":"http","scheme":"bearer"}}}}